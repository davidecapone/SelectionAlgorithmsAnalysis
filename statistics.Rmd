```{r}
library(dplyr)
library(ggplot2)
library(latex2exp)
```
```{r}
# import
half_n = read.csv("dataset/half_n.csv")
square_n = read.csv("dataset/square_n.csv")
random_k = read.csv("dataset/random_k.csv")
quickselect_worst = read.csv("dataset/quickselect_worst.csv")
hundred_n = read.csv("dataset/hundred_n.csv")
#static_size = read.csv("dataset/static_size.csv")
```
```{r}
# generating stats for each analysis:

half_n_stats = half_n %>%
  group_by(size) %>%
  summarise( quickselect_average = mean(quickselect), quickselect_variance = var(quickselect) ,
             heapselect_average = mean(heapselect), heapselect_variance = var(heapselect),
             medianmediansselect_average = mean(medianmediansselect), medianmediansselect_variance = var(medianmediansselect))

square_n_stats = square_n %>%
  group_by(size) %>%
  summarise( quickselect_average = mean(quickselect), quickselect_variance = var(quickselect) ,
             heapselect_average = mean(heapselect), heapselect_variance = var(heapselect),
             medianmediansselect_average = mean(medianmediansselect), medianmediansselect_variance = var(medianmediansselect))

random_k_stats = random_k %>%
  group_by(size) %>%
  summarise( quickselect_average = mean(quickselect), quickselect_variance = var(quickselect) ,
             heapselect_average = mean(heapselect), heapselect_variance = var(heapselect),
             medianmediansselect_average = mean(medianmediansselect), medianmediansselect_variance = var(medianmediansselect))

hundred_n_stats = hundred_n %>%
  group_by(size) %>%
  summarise( quickselect_average = mean(quickselect), quickselect_variance = var(quickselect) ,
             heapselect_average = mean(heapselect), heapselect_variance = var(heapselect),
             medianmediansselect_average = mean(medianmediansselect), medianmediansselect_variance = var(medianmediansselect))

quickselect_worst_stats = quickselect_worst %>%
  group_by(size) %>%
  summarise( quickselect_average = mean(quickselect), quickselect_variance = var(quickselect))

#static_size_stats = static_size %>%
#  group_by(k) %>%
#  summarise( quickselect_average = mean(quickselect), quickselect_variance = var(quickselect) ,
#             heapselect_average = mean(heapselect), heapselect_variance = var(heapselect),
#             medianmediansselect_average = mean(medianmediansselect), medianmediansselect_variance = var(medianmediansselect))
```
```{r}
# palette:
quickselect_color = "#4CAF50"
heapSelect_color = "#FF9800"
medianMediansSelect_color = "#8D6E63"

```

```{r}
# LINEAR SCALE GRAPHS:
# k random:
random_k_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica k random"),
       subtitle = "20 campioni per dimensione",
       caption = "scala lineare") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color))+
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"))

# square n:
square_n_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica $k = \\sqrt{n}$"),
       subtitle = "20 campioni per dimensione",
       caption = "scala lineare") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color)) +
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"))

# half n:
half_n_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica $k = \\frac{n}{2}$"),
       subtitle = "20 campioni per dimensione",
       caption = "scala lineare") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color)) +
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"))

# hundred n:
hundred_n_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica $k = \\frac{n}{100}$"),
       subtitle = "20 campioni per dimensione",
       caption = "scala lineare") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color)) +
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"))

# quick select worst case:
quickselect_worst_stats %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica caso pessimo quickSelect"),
       subtitle = "50 campioni per dimensione",
       caption = "scala lineare") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color))
```
```{r}
# LOG SCALE GRAPHS:
# k random:
random_k_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica con k random"),
       subtitle = "20 campioni per ogni dimensione",
       caption = "scala doppiamente logaritmica") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color))+
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"), trans = 'log2') +
  scale_y_continuous(trans='log2')

# square n:
square_n_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica con $k = \\sqrt{n}$"),
       subtitle = "20 campioni per ogni dimensione",
       caption = "scala doppiamente logaritmica") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color)) +
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"), trans = 'log2') +
  scale_y_continuous(trans='log2')

# half n:
half_n_stats  %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  geom_line(aes(y=heapselect_average,colour="heapSelect"),size=1) +
  geom_line(aes(y=medianmediansselect_average,colour="medianMediansSelect"),size=1) +
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica con $k = \\frac{n}{2}$"),
       subtitle = "20 campioni per ogni dimensione",
       caption = "scala doppiamente logaritmica") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color, "heapSelect" = heapSelect_color, "medianMediansSelect" = medianMediansSelect_color)) +
  scale_x_continuous(breaks = c(100, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("100", "1M", "2M", "3M", "4M", "5M"), trans = 'log2') +
  scale_y_continuous(trans='log2')

# quick select worst case:
quickselect_worst_stats %>% ggplot( aes(x = size) ) + 
  geom_line(aes(y=quickselect_average,colour="quickSelect"),size=1 )+
  labs(x = "dimensione", y = "tempo", 
       title = TeX("Analisi asintotica caso pessimo quickSelect"),
       subtitle = "50 campioni per ogni dimensione",
       caption = "scala doppiamente logaritmica") +
  scale_color_manual(name = "Algoritmi selezione", values = c("quickSelect" = quickselect_color)) +
  scale_x_continuous(trans = 'log') +
  scale_y_continuous(trans = 'log')
```




